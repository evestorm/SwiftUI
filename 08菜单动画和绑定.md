# 菜单动画和绑定

## 添加按钮用来切换菜单的弹出和隐藏

![image-20200726161828625](images/image-20200726161828625.png)

## 为按钮添加动作

![image-20200726162122807](images/image-20200726162122807.png)

```swift
Button(action: { self.show.toggle() }) {
  Text("Open Menu")
}
```

![image-20200726162211127](images/image-20200726162211127.png)

给菜单添加 `animation` 弹性动画：

![image-20200726163402139](images/image-20200726163402139.png)

然后，在Menu上添加tap事件用来隐藏自己：

![image-20200726162426890](images/image-20200726162426890.png)

最后为菜单添加3d旋转效果：

![image-20200726163435916](images/image-20200726163435916.png)

关于3d变化的讲解，可点击[此处](https://daddycoding.com/2020/03/19/swiftui-rotation-effect/)了解更多。

## 抽离组件

按照之前方案抽离菜单组件：

![image-20200726163818560](images/image-20200726163818560.png)

但下方会出现报错：

![image-20200726163840873](images/image-20200726163840873.png)

因为缺少一些必要的参数。我们先把之前主视图的 `menu` 变量移过来：

![image-20200726164047856](images/image-20200726164047856.png)

>  @Binding
>
>  有时候我们会把一个视图的属性传至子节点中，但是又不能直接的传递给子节点，因为在 Swift 中值的传递形式是`值类型`传递方式，也就是传递给子节点的是一个拷贝过的值。但是通过 @Binding 修饰器修饰后，属性变成了一个`引用类型`，传递变成了引用传递，这样父子视图的状态就能关联起来了。

然后在子视图中新建一个 show 变量，并在前面用 `@Binding` 修饰，这是为了让子视图的属性和它父视图的属性建立关联。因为我们在 `MenuView` 中修改了 show 状态的值，并且希望这个状态能同步修改父视图中的 show 属性值。

为了实现这一点，我们有三个必要事情要做：

1. 第一步就得在子视图的 show 属性前添加关键词 `@Binding` （已完成）
2. 父视图的属性前面得用 `@State` 修饰（已完成）
3. 当把父视图的`@State`属性传到子视图的时候，在属性名前面加上`$`。

这样我们就建立了关联。

前两步已完成，现在该传递参数了：

```swift
MenuView(show: $show)
```

![image-20200726165051228](images/image-20200726165051228.png)

